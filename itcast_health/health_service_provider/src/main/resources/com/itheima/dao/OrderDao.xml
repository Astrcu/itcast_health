<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itheima.dao.OrderDao">

    <insert id="addOrder" parameterType="order" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        INSERT INTO `t_order` (`id`, `member_id`, `orderDate`, `orderType`, `orderStatus`, `setmeal_id`)
         VALUES (null , #{memberId}, #{orderDate}, #{orderType}, #{orderStatus}, #{setmealId});
    </insert>

    <select id="findByOrder" parameterType="order" resultType="long">
        select count(0) from t_order where member_id = #{memberId}
            and orderDate = #{orderDate}
            and setmeal_id = #{setmealId}
    </select>

    <select id="findById" parameterType="int" resultType="map">
            SELECT
                m.name member,
                s.remark setmeal,
                o.orderDate,
                o.orderType
            FROM
                t_order o,
                t_setmeal s,
                t_member m
            WHERE
                o.setmeal_id = s.id
            AND o.member_id = m.id
            AND o.id = #{id}
    </select>

    <select id="findTodayOrderNumber" parameterType="string" resultType="long">
          select count(0) from t_order where orderDate = #{reportDate}
    </select>

    <select id="findTodayVisitsNumber" resultType="long">
        select count(0) from t_order where orderDate = #{reportDate} and orderStatus = '已到诊'
    </select>

    <select id="findOrderNumberByBetweenDate" resultType="long">
        select count(0) from t_order where orderDate between #{param1} and #{param2}
    </select>

    <select id="findVisitsNumberByAfterDate" resultType="long">
        select count(0) from t_order where orderDate &gt;= #{thisWeekMonday} and orderStatus = '已到诊'
    </select>
</mapper>